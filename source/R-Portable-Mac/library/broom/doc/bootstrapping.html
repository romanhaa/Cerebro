<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">


<meta name="date" content="2018-12-04" />

<title>Tidy bootstrapping</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>



<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#header {
text-align: center;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; }  code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>

</head>

<body>




<h1 class="title toc-ignore">Tidy bootstrapping</h1>
<h4 class="date"><em>2018-12-04</em></h4>



<div id="tidy-bootstrapping" class="section level1">
<h1>Tidy bootstrapping</h1>
<p>Another place where combining model fits in a tidy way becomes useful is when performing bootstrapping or permutation tests. These approaches have been explored before, for instance by <a href="http://rstudio-pubs-static.s3.amazonaws.com/19698_a4c472606e3c43e4b94720506e49bb7b.html">Andrew MacDonald here</a>, and <a href="https://github.com/hadley/dplyr/issues/269">Hadley has explored efficient support for bootstrapping</a> as a potential enhancement to dplyr. broom fits naturally with dplyr in performing these analyses.</p>
<p>Bootstrapping consists of randomly sampling a dataset with replacement, then performing the analysis individually on each bootstrapped replicate. The variation in the resulting estimate is then a reasonable approximation of the variance in our estimate.</p>
<p>Letâ€™s say we want to fit a nonlinear model to the weight/mileage relationship in the <code>mtcars</code> dataset.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw">library</span>(ggplot2)</a>
<a class="sourceLine" id="cb1-2" data-line-number="2"><span class="co">#&gt; Warning: package &#39;ggplot2&#39; was built under R version 3.5.1</span></a>
<a class="sourceLine" id="cb1-3" data-line-number="3"></a>
<a class="sourceLine" id="cb1-4" data-line-number="4"><span class="kw">ggplot</span>(mtcars, <span class="kw">aes</span>(mpg, wt)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1-5" data-line-number="5"><span class="st">    </span><span class="kw">geom_point</span>()</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>We might use the method of nonlinear least squares (via the <code>nls</code> function) to fit a model.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1">nlsfit &lt;-<span class="st"> </span><span class="kw">nls</span>(mpg <span class="op">~</span><span class="st"> </span>k <span class="op">/</span><span class="st"> </span>wt <span class="op">+</span><span class="st"> </span>b, mtcars, <span class="dt">start =</span> <span class="kw">list</span>(<span class="dt">k =</span> <span class="dv">1</span>, <span class="dt">b =</span> <span class="dv">0</span>))</a>
<a class="sourceLine" id="cb2-2" data-line-number="2"><span class="kw">summary</span>(nlsfit)</a>
<a class="sourceLine" id="cb2-3" data-line-number="3"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb2-4" data-line-number="4"><span class="co">#&gt; Formula: mpg ~ k/wt + b</span></a>
<a class="sourceLine" id="cb2-5" data-line-number="5"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb2-6" data-line-number="6"><span class="co">#&gt; Parameters:</span></a>
<a class="sourceLine" id="cb2-7" data-line-number="7"><span class="co">#&gt;   Estimate Std. Error t value Pr(&gt;|t|)    </span></a>
<a class="sourceLine" id="cb2-8" data-line-number="8"><span class="co">#&gt; k   45.829      4.249  10.786 7.64e-12 ***</span></a>
<a class="sourceLine" id="cb2-9" data-line-number="9"><span class="co">#&gt; b    4.386      1.536   2.855  0.00774 ** </span></a>
<a class="sourceLine" id="cb2-10" data-line-number="10"><span class="co">#&gt; ---</span></a>
<a class="sourceLine" id="cb2-11" data-line-number="11"><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></a>
<a class="sourceLine" id="cb2-12" data-line-number="12"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb2-13" data-line-number="13"><span class="co">#&gt; Residual standard error: 2.774 on 30 degrees of freedom</span></a>
<a class="sourceLine" id="cb2-14" data-line-number="14"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb2-15" data-line-number="15"><span class="co">#&gt; Number of iterations to convergence: 1 </span></a>
<a class="sourceLine" id="cb2-16" data-line-number="16"><span class="co">#&gt; Achieved convergence tolerance: 2.877e-08</span></a>
<a class="sourceLine" id="cb2-17" data-line-number="17"></a>
<a class="sourceLine" id="cb2-18" data-line-number="18"><span class="kw">ggplot</span>(mtcars, <span class="kw">aes</span>(wt, mpg)) <span class="op">+</span></a>
<a class="sourceLine" id="cb2-19" data-line-number="19"><span class="st">    </span><span class="kw">geom_point</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb2-20" data-line-number="20"><span class="st">    </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">y =</span> <span class="kw">predict</span>(nlsfit)))</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>While this does provide a p-value and confidence intervals for the parameters, these are based on model assumptions that may not hold in real data. Bootstrapping is a popular method for providing confidence intervals and predictions that are more robust to the nature of the data.</p>
<p>We can use the <code>bootstraps</code> function in the <strong>rsample</strong> package to sample bootstrap replications. First, we construct 100 bootstrap replications of the data, each of which has been randomly sampled with replacement. The resulting object is an <code>rset</code>, which is a dataframe with a column of <code>rsplit</code> objects.</p>
<p>An <code>rsplit</code> object has two main components: an analysis dataset and an assessment dataset, accessible via <code>analysis(rsplit)</code> and <code>assessment(rsplit)</code> respectively. For bootstrap samples, the analysis dataset is the bootstrap sample itself, and the assessment dataset consists of all the out of bag samples.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="kw">library</span>(dplyr)</a>
<a class="sourceLine" id="cb3-2" data-line-number="2"><span class="kw">library</span>(rsample)</a>
<a class="sourceLine" id="cb3-3" data-line-number="3"><span class="co">#&gt; Warning: package &#39;rsample&#39; was built under R version 3.5.1</span></a>
<a class="sourceLine" id="cb3-4" data-line-number="4"><span class="co">#&gt; Warning: package &#39;tidyr&#39; was built under R version 3.5.1</span></a>
<a class="sourceLine" id="cb3-5" data-line-number="5"><span class="kw">library</span>(broom)</a>
<a class="sourceLine" id="cb3-6" data-line-number="6"><span class="kw">library</span>(purrr)</a>
<a class="sourceLine" id="cb3-7" data-line-number="7"></a>
<a class="sourceLine" id="cb3-8" data-line-number="8"><span class="kw">set.seed</span>(<span class="dv">27</span>)</a>
<a class="sourceLine" id="cb3-9" data-line-number="9"></a>
<a class="sourceLine" id="cb3-10" data-line-number="10">boots &lt;-<span class="st"> </span><span class="kw">bootstraps</span>(mtcars, <span class="dt">times =</span> <span class="dv">100</span>)</a>
<a class="sourceLine" id="cb3-11" data-line-number="11">boots</a>
<a class="sourceLine" id="cb3-12" data-line-number="12"><span class="co">#&gt; # Bootstrap sampling </span></a>
<a class="sourceLine" id="cb3-13" data-line-number="13"><span class="co">#&gt; # A tibble: 100 x 2</span></a>
<a class="sourceLine" id="cb3-14" data-line-number="14"><span class="co">#&gt;    splits          id          </span></a>
<a class="sourceLine" id="cb3-15" data-line-number="15"><span class="co">#&gt;    &lt;list&gt;          &lt;chr&gt;       </span></a>
<a class="sourceLine" id="cb3-16" data-line-number="16"><span class="co">#&gt;  1 &lt;split [32/12]&gt; Bootstrap001</span></a>
<a class="sourceLine" id="cb3-17" data-line-number="17"><span class="co">#&gt;  2 &lt;split [32/15]&gt; Bootstrap002</span></a>
<a class="sourceLine" id="cb3-18" data-line-number="18"><span class="co">#&gt;  3 &lt;split [32/10]&gt; Bootstrap003</span></a>
<a class="sourceLine" id="cb3-19" data-line-number="19"><span class="co">#&gt;  4 &lt;split [32/10]&gt; Bootstrap004</span></a>
<a class="sourceLine" id="cb3-20" data-line-number="20"><span class="co">#&gt;  5 &lt;split [32/12]&gt; Bootstrap005</span></a>
<a class="sourceLine" id="cb3-21" data-line-number="21"><span class="co">#&gt;  6 &lt;split [32/12]&gt; Bootstrap006</span></a>
<a class="sourceLine" id="cb3-22" data-line-number="22"><span class="co">#&gt;  7 &lt;split [32/13]&gt; Bootstrap007</span></a>
<a class="sourceLine" id="cb3-23" data-line-number="23"><span class="co">#&gt;  8 &lt;split [32/9]&gt;  Bootstrap008</span></a>
<a class="sourceLine" id="cb3-24" data-line-number="24"><span class="co">#&gt;  9 &lt;split [32/9]&gt;  Bootstrap009</span></a>
<a class="sourceLine" id="cb3-25" data-line-number="25"><span class="co">#&gt; 10 &lt;split [32/14]&gt; Bootstrap010</span></a>
<a class="sourceLine" id="cb3-26" data-line-number="26"><span class="co">#&gt; # ... with 90 more rows</span></a></code></pre></div>
<p>We create a helper function to fit an <code>nls</code> model on each bootstrap sample, and then use <code>purrr::map</code> to apply this function to all the bootstrap samples at once. Similarly, we create a column of tidy coefficient information by unnesting.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1">fit_nls_on_bootstrap &lt;-<span class="st"> </span><span class="cf">function</span>(split) {</a>
<a class="sourceLine" id="cb4-2" data-line-number="2">    <span class="kw">nls</span>(mpg <span class="op">~</span><span class="st"> </span>k <span class="op">/</span><span class="st"> </span>wt <span class="op">+</span><span class="st"> </span>b, <span class="kw">analysis</span>(split), <span class="dt">start =</span> <span class="kw">list</span>(<span class="dt">k =</span> <span class="dv">1</span>, <span class="dt">b =</span> <span class="dv">0</span>))</a>
<a class="sourceLine" id="cb4-3" data-line-number="3">}</a>
<a class="sourceLine" id="cb4-4" data-line-number="4"></a>
<a class="sourceLine" id="cb4-5" data-line-number="5">boot_models &lt;-<span class="st"> </span>boots <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb4-6" data-line-number="6"><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">model =</span> <span class="kw">map</span>(splits, fit_nls_on_bootstrap),</a>
<a class="sourceLine" id="cb4-7" data-line-number="7">           <span class="dt">coef_info =</span> <span class="kw">map</span>(model, tidy))</a>
<a class="sourceLine" id="cb4-8" data-line-number="8"></a>
<a class="sourceLine" id="cb4-9" data-line-number="9">boot_coefs &lt;-<span class="st"> </span>boot_models <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb4-10" data-line-number="10"><span class="st">    </span><span class="kw">unnest</span>(coef_info)</a></code></pre></div>
<p>The unnested coefficient information contains a summary of each replication combined in a single data frame:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1">boot_coefs</a>
<a class="sourceLine" id="cb5-2" data-line-number="2"><span class="co">#&gt; # A tibble: 200 x 6</span></a>
<a class="sourceLine" id="cb5-3" data-line-number="3"><span class="co">#&gt;    id           term  estimate std.error statistic  p.value</span></a>
<a class="sourceLine" id="cb5-4" data-line-number="4"><span class="co">#&gt;    &lt;chr&gt;        &lt;chr&gt;    &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb5-5" data-line-number="5"><span class="co">#&gt;  1 Bootstrap001 k       42.1        3.76    11.2   2.99e-12</span></a>
<a class="sourceLine" id="cb5-6" data-line-number="6"><span class="co">#&gt;  2 Bootstrap001 b        5.76       1.43     4.02  3.60e- 4</span></a>
<a class="sourceLine" id="cb5-7" data-line-number="7"><span class="co">#&gt;  3 Bootstrap002 k       46.3        3.72    12.4   2.26e-13</span></a>
<a class="sourceLine" id="cb5-8" data-line-number="8"><span class="co">#&gt;  4 Bootstrap002 b        4.10       1.43     2.87  7.38e- 3</span></a>
<a class="sourceLine" id="cb5-9" data-line-number="9"><span class="co">#&gt;  5 Bootstrap003 k       56.1        3.80    14.7   2.77e-15</span></a>
<a class="sourceLine" id="cb5-10" data-line-number="10"><span class="co">#&gt;  6 Bootstrap003 b        0.935      1.31     0.713 4.82e- 1</span></a>
<a class="sourceLine" id="cb5-11" data-line-number="11"><span class="co">#&gt;  7 Bootstrap004 k       43.5        3.39    12.8   1.06e-13</span></a>
<a class="sourceLine" id="cb5-12" data-line-number="12"><span class="co">#&gt;  8 Bootstrap004 b        4.83       1.33     3.62  1.06e- 3</span></a>
<a class="sourceLine" id="cb5-13" data-line-number="13"><span class="co">#&gt;  9 Bootstrap005 k       41.3        3.74    11.0   4.26e-12</span></a>
<a class="sourceLine" id="cb5-14" data-line-number="14"><span class="co">#&gt; 10 Bootstrap005 b        5.37       1.31     4.11  2.81e- 4</span></a>
<a class="sourceLine" id="cb5-15" data-line-number="15"><span class="co">#&gt; # ... with 190 more rows</span></a></code></pre></div>
<p>We can then calculate confidence intervals (using what is called the <a href="https://www.uvm.edu/~dhowell/StatPages/Randomization%20Tests/ResamplingWithR/BootstMeans/bootstrapping_means.html">percentile method</a>):</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1">alpha &lt;-<span class="st"> </span><span class="fl">.05</span></a>
<a class="sourceLine" id="cb6-2" data-line-number="2">boot_coefs <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb6-3" data-line-number="3"><span class="st">    </span><span class="kw">group_by</span>(term) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb6-4" data-line-number="4"><span class="st">    </span><span class="kw">summarize</span>(<span class="dt">low =</span> <span class="kw">quantile</span>(estimate, alpha <span class="op">/</span><span class="st"> </span><span class="dv">2</span>),</a>
<a class="sourceLine" id="cb6-5" data-line-number="5">              <span class="dt">high =</span> <span class="kw">quantile</span>(estimate, <span class="dv">1</span> <span class="op">-</span><span class="st"> </span>alpha <span class="op">/</span><span class="st"> </span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb6-6" data-line-number="6"><span class="co">#&gt; # A tibble: 2 x 3</span></a>
<a class="sourceLine" id="cb6-7" data-line-number="7"><span class="co">#&gt;   term      low  high</span></a>
<a class="sourceLine" id="cb6-8" data-line-number="8"><span class="co">#&gt;   &lt;chr&gt;   &lt;dbl&gt; &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb6-9" data-line-number="9"><span class="co">#&gt; 1 b      -0.695  7.40</span></a>
<a class="sourceLine" id="cb6-10" data-line-number="10"><span class="co">#&gt; 2 k      38.7   62.3</span></a></code></pre></div>
<p>Or we can use histograms to get a more detailed idea of the uncertainty in each estimate:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1"><span class="kw">ggplot</span>(boot_coefs, <span class="kw">aes</span>(estimate)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb7-2" data-line-number="2"><span class="st">    </span><span class="kw">geom_histogram</span>(<span class="dt">binwidth =</span> <span class="dv">2</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb7-3" data-line-number="3"><span class="st">    </span><span class="kw">facet_wrap</span>(<span class="op">~</span><span class="st"> </span>term, <span class="dt">scales =</span> <span class="st">&quot;free&quot;</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Or we can use <code>augment</code> to visualize the uncertainty in the curve:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1">boot_aug &lt;-<span class="st"> </span>boot_models <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb8-2" data-line-number="2"><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">augmented =</span> <span class="kw">map</span>(model, augment)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb8-3" data-line-number="3"><span class="st">    </span><span class="kw">unnest</span>(augmented)</a>
<a class="sourceLine" id="cb8-4" data-line-number="4"></a>
<a class="sourceLine" id="cb8-5" data-line-number="5">boot_aug</a>
<a class="sourceLine" id="cb8-6" data-line-number="6"><span class="co">#&gt; # A tibble: 3,200 x 5</span></a>
<a class="sourceLine" id="cb8-7" data-line-number="7"><span class="co">#&gt;    id             mpg    wt .fitted .resid</span></a>
<a class="sourceLine" id="cb8-8" data-line-number="8"><span class="co">#&gt;    &lt;chr&gt;        &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb8-9" data-line-number="9"><span class="co">#&gt;  1 Bootstrap001  21.4  2.78    20.9  0.484</span></a>
<a class="sourceLine" id="cb8-10" data-line-number="10"><span class="co">#&gt;  2 Bootstrap001  22.8  2.32    23.9 -1.12 </span></a>
<a class="sourceLine" id="cb8-11" data-line-number="11"><span class="co">#&gt;  3 Bootstrap001  30.4  1.51    33.6 -3.20 </span></a>
<a class="sourceLine" id="cb8-12" data-line-number="12"><span class="co">#&gt;  4 Bootstrap001  17.8  3.44    18.0 -0.209</span></a>
<a class="sourceLine" id="cb8-13" data-line-number="13"><span class="co">#&gt;  5 Bootstrap001  24.4  3.19    19.0  5.43 </span></a>
<a class="sourceLine" id="cb8-14" data-line-number="14"><span class="co">#&gt;  6 Bootstrap001  17.3  3.73    17.1  0.243</span></a>
<a class="sourceLine" id="cb8-15" data-line-number="15"><span class="co">#&gt;  7 Bootstrap001  22.8  2.32    23.9 -1.12 </span></a>
<a class="sourceLine" id="cb8-16" data-line-number="16"><span class="co">#&gt;  8 Bootstrap001  21    2.62    21.8 -0.841</span></a>
<a class="sourceLine" id="cb8-17" data-line-number="17"><span class="co">#&gt;  9 Bootstrap001  18.7  3.44    18.0  0.691</span></a>
<a class="sourceLine" id="cb8-18" data-line-number="18"><span class="co">#&gt; 10 Bootstrap001  14.3  3.57    17.6 -3.26 </span></a>
<a class="sourceLine" id="cb8-19" data-line-number="19"><span class="co">#&gt; # ... with 3,190 more rows</span></a></code></pre></div>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1"><span class="kw">ggplot</span>(boot_aug, <span class="kw">aes</span>(wt, mpg)) <span class="op">+</span></a>
<a class="sourceLine" id="cb9-2" data-line-number="2"><span class="st">    </span><span class="kw">geom_point</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb9-3" data-line-number="3"><span class="st">    </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">y =</span> .fitted, <span class="dt">group =</span> id), <span class="dt">alpha=</span>.<span class="dv">2</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>With only a few small changes, we could easily perform bootstrapping with other kinds of predictive or hypothesis testing models, since the <code>tidy</code> and <code>augment</code> functions works for many statistical outputs. As another example, we could use <code>smooth.spline</code>, which fits a cubic smoothing spline to data:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1">fit_spline_on_bootstrap &lt;-<span class="st"> </span><span class="cf">function</span>(split) {</a>
<a class="sourceLine" id="cb10-2" data-line-number="2">    data &lt;-<span class="st"> </span><span class="kw">analysis</span>(split)</a>
<a class="sourceLine" id="cb10-3" data-line-number="3">    <span class="kw">smooth.spline</span>(data<span class="op">$</span>wt, data<span class="op">$</span>mpg, <span class="dt">df =</span> <span class="dv">4</span>)</a>
<a class="sourceLine" id="cb10-4" data-line-number="4">}</a>
<a class="sourceLine" id="cb10-5" data-line-number="5"></a>
<a class="sourceLine" id="cb10-6" data-line-number="6">boot_splines &lt;-<span class="st"> </span>boots <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb10-7" data-line-number="7"><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">spline =</span> <span class="kw">map</span>(splits, fit_spline_on_bootstrap),</a>
<a class="sourceLine" id="cb10-8" data-line-number="8">           <span class="dt">aug_train =</span> <span class="kw">map</span>(spline, augment))</a>
<a class="sourceLine" id="cb10-9" data-line-number="9"></a>
<a class="sourceLine" id="cb10-10" data-line-number="10">splines_aug &lt;-<span class="st"> </span>boot_splines <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb10-11" data-line-number="11"><span class="st">    </span><span class="kw">unnest</span>(aug_train)</a>
<a class="sourceLine" id="cb10-12" data-line-number="12"></a>
<a class="sourceLine" id="cb10-13" data-line-number="13"><span class="kw">ggplot</span>(splines_aug, <span class="kw">aes</span>(x, y)) <span class="op">+</span></a>
<a class="sourceLine" id="cb10-14" data-line-number="14"><span class="st">    </span><span class="kw">geom_point</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb10-15" data-line-number="15"><span class="st">    </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">y =</span> .fitted, <span class="dt">group =</span> id), <span class="dt">alpha =</span> <span class="fl">0.2</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
